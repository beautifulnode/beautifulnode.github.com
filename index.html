<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>BeautifulNode</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/stylesheets/bootstrap.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
    </style>
    <link href="/stylesheets/bootstrap-responsive.css" rel="stylesheet">
    <link href="/stylesheets/github.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/images/favicon.ico">
    <link rel="apple-touch-icon" href="/images/bootstrap-apple-57x57.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/bootstrap-apple-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/bootstrap-apple-114x114.png">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="#">Beautiful Node</a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about">About</a></li>
              <li><a href="/contact">Contact</a></li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container">
      <div class="hero-unit">
        <h1>Beautiful Node</h1>
        <p>Where CoffeeScript and NodeJs meet to create awesomeness!</p>
        <p><a class="btn btn-primary btn-large">Learn more &raquo;</a></p>
      </div>
      <div class='row'>
        <div class="span4">
          <div class="hero-unit">
            <ul>
              <li><a href="#hello-world">Hello World</a></li>
              <li><a href="#npm">NPM</a></li>
            </ul>
          </div>
        </div>
        <div class="span8 github">
        <p><a id="hello-world"></a></p>

<h1>Hello World</h1>

<p><em>posted 2012-02-18 by <a href="http://twitter.com/twilson63">@twilson63</a></em></p>

<h2>Introduction</h2>

<p>A nodejs and coffeescript hello world tutorial.</p>

<h2>Requirements</h2>

<p><a href="http://nodejs.org">nodejs</a></p>

<h2>Install CoffeeScript</h2>

<div class="highlight"><pre lang=" sh">npm install coffee-script -g
</pre></div>

<h2>Code</h2>

<p>Lets go ahead and create our first web server using nodejs and coffeescript.</p>

<p>In your favorite text editor type the following:</p>

<div class="highlight"><pre lang=" coffeescript">http = require 'http'

server = http.createServer (request, response) ->
  response.writeHead 200, 'Content-Type: text/plain'
  response.end 'Hello World'

server.listen 3000, console.log 'listening on 3000...'
</pre></div>

<p>Save the file as server.coffee.</p>

<p>Open a command prompt in the directory that the server.coffee file is in.</p>

<p>Run the following:</p>

<div class="highlight"><pre lang=" sh">coffee server.coffee
</pre></div>

<p>You should see the prompt return "listening on 3000...", now you should be able to open a browser at '<a href='http://localhost:3000'>http://localhost:3000</a>' and see 'Hello World'.</p>

<p>Congratulations! You just created your first nodejs web server.</p>

<p>Press CTRL-C in the command window to stop the server.</p>

<h2>Compile the server</h2>

<p>Lets compile your coffeescript into javascript.</p>

<p>In the command window we will execute the coffee command we did previously, but this time we will add a -c flag to tell coffeescript to compile the coffee file to a javascript file.</p>

<div class="highlight"><pre lang=" sh">coffee -c server.coffee
</pre></div>

<p>This will create a new file in the same directory called 'server.js'.  You can open server.js and you should see the generated javascript like this.</p>

<div class="highlight"><pre lang=" javascript">var http, server;

http = require('http');

server = http.createServer(function(request, response) {
  response.writeHead(200, 'Content-Type: text/plain');
  return response.end('Hello World');
});

server.listen(3000, console.log('listening on 3000...'));
</pre></div>

<hr />

<p><a id="npm" style="padding-bottom:60px;" href="/">Top</a></p>

<h1>NPM</h1>

<p><em>posted 2012-02-19 by <a href="http://twitter.com/twilson63">@twilson63</a></em></p>

<p>NPM is the module package manager that ships with nodejs.  You can use npm<br />to organize your dependencies and create and ship reusable modules that you create.</p>

<h2>Package.Json</h2>

<p>When building a nodejs application, you want to reuse modules from the nodejs community.  There are over 7000 modules to choose from and that can be quite challenging to choose the best modules.  But once you do, organizing in your application is easy.</p>

<p>Using your command shell, navigate to your application folder and type:</p>

<div class="highlight"><pre lang=" sh">npm init
</pre></div>

<p>You will be prompted through a series of questions about your project:</p>

<div class="highlight"><pre lang=" sh">Package name:
Description:
Package version:
Project homepage:
Project git repository:
Author name:
Author email:
Author url:
Main module/entry point:
Test command:
What versions of node does it run on?
</pre></div>

<p>Once you complete the questions, you will end up with a file in your folder called package.json.  And it should look similar to this:</p>

<div class="highlight"><pre lang=" json">{
  "author": "",
  "name": "foo",
  "version": "0.0.0",
  "repository": {
    "url": ""
  },
  "engines": {
    "node": "~0.6.7"
  },
  "dependencies": {},
  "devDependencies": {}
}
</pre></div>

<p>You will notice two empty sections, "dependencies" and "devDependencies".  The "dependencies" section is the area we want to put or module dependencies.  For example, if we are going to create a simple static file server, we may want to use a module called "filed" that already implements the streaming of files as well as adding the appropriate mime types based on the file extensions.  So we would add filed to the package.json dependencies node.</p>

<div class="highlight"><pre lang=" json">{
  "author": "",
  "name": "foo",
  "version": "0.0.0",
  "repository": {
    "url": ""
  },
  "engines": {
    "node": "~0.6.7"
  },
  "dependencies": {
    "filed": "*"
  },
  "devDependencies": {}
}
</pre></div>

<p>As you can see, we put the module name as the key and an asterisk as the value of the element.  This will tell npm to pull the latest version.  Once your are ready to ship you app, you should change this to the exact version of the module you are using, this will keep your code consistent.  To pull the module down to your application, open your command shell and navigate to your application folder and type:</p>

<div class="highlight"><pre lang=" sh">npm install
</pre></div>

<p>By running the npm install command, npm will look at your dependencies in your package.json and install them into the node_modules folder underneath your application directory.</p>

<p>NPM is an invaluable tool at managing dependencies, but it can also be used for so much more.  You can use it to document your start command and test command.  To find out more about npm and all of its features, just type :</p>

<div class="highlight"><pre lang=" sh">npm help npm
</pre></div>

<p>And you will get a detailed overview of each function of the application. </p>

<hr />

<p><a id="npm" style="padding-bottom:60px;" href="/">Top</a></p>

<h1>http.request</h1>

<p><em>posted 2012-02-19 by <a href="http://twitter.com/twilson63">@twilson63</a></em></p>

<p>http.request is a function on the http module that enables you to perform an http request to an http server.  The request method returns a ClientRequest object that you can write to.  We will show an example of performing an http get to a json api and a http post to a json api.  You can use this client to also send head, put and delete, but we will demonstrate get and post.</p>

<p>Lets go ahead and create a new project directory:</p>

<div class="highlight"><pre lang=" sh">mkdir httpclient
cd httpclient
npm init
</pre></div>

<p>Follow the defaults, then edit the package.json file and add the following dependencies:</p>

<div class="highlight"><pre lang=" json">{
  "dependencies": {
    "coffee-script": "*"
  }
}
</pre></div>

<p>Next, lets run and create index.coffee:</p>

<div class="highlight"><pre lang=" sh">npm install
touch index.coffee
</pre></div>

<p>Lets open index.coffee and create a client to do a simple twitter search:</p>

<div class="highlight"><pre lang=" coffeescript">http = require 'http'
log = console.log

options =
  host: 'www.twitter.com'
  port: 80
  path: '/search.json?q=nodejs'
  method: 'GET'
  headers: 
    'Content-Type': 'application/json'

req = http.request options, (resp) ->
    log resp.statusCode
    body = ""
    resp.on 'data', (data) -> 
      body += data.toString()
    resp.on 'end', ->
      for doc in JSON.parse(body).results
        log '<==========================================>'
        log doc.text

req.on 'error', (err) -> log err
req.end()
</pre></div>

<p>Save the file and run:</p>

<div class="highlight"><pre lang=" sh">coffee index.coffee
</pre></div>

<p>And you should get a list of tweets for nodejs.</p>

<p>So lets break it down into parts to describe whats going on.  The first thing we are doing is creating and options object that we will pass into the http.request method.  This object defines the host, port, path, method and headers.  When we call the http.request object, it will return a ClientRequest object that is ready to go, all we need to do is to call end on the newly created ClientRequest Object and node will send the request to the server.  The second argument of the http.request method is a callback which returns a response object.  This callback will fire when the server returns with a response.  This allows us to create some listeners on the the response object to capture the data returned and when the response ends.  To do this we use the on method to receive events from the response object.  The data event fires during the course of the response, then when the response is finished the end event fires.  So as the data event fires we start building the body, and when the end event fires, we know the body of the message is complete and we can start to parse it and work with the data.  For our purposes, we are just sending each tweet to the console.  Lastly, we hook into the request error event, in the case of the site being down or we are not connected to the internet, we should get a fairly descriptive error.  And we call the end method on the request object to invoke the process.</p>
        </div>
      </div>
      <hr>
      <footer>
        <p>&copy; BeautifulNode 2012</p>
      </footer>
    </div> <!-- /container -->

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/javascripts/jquery.js"></script>
    <script src="/javascripts/bootstrap-transition.js"></script>
    <script src="/javascripts/bootstrap-alert.js"></script>
    <script src="/javascripts/bootstrap-modal.js"></script>
    <script src="/javascripts/bootstrap-dropdown.js"></script>
    <script src="/javascripts/bootstrap-scrollspy.js"></script>
    <script src="/javascripts/bootstrap-tab.js"></script>
    <script src="/javascripts/bootstrap-tooltip.js"></script>
    <script src="/javascripts/bootstrap-popover.js"></script>
    <script src="/javascripts/bootstrap-button.js"></script>
    <script src="/javascripts/bootstrap-collapse.js"></script>
    <script src="/javascripts/bootstrap-carousel.js"></script>
    <script src="/javascripts/bootstrap-typeahead.js"></script>

  </body>
</html>
